[{"jobId":116,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:43.526Z","completionTime":"2016-10-10T21:40:47.699Z","stageIds":[204,208,205,209,206,207],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":523,"numActiveTasks":0,"numCompletedTasks":523,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":6,"numSkippedStages":0,"numFailedStages":0},{"jobId":115,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:40.121Z","completionTime":"2016-10-10T21:40:43.375Z","stageIds":[202,203],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":140,"numActiveTasks":0,"numCompletedTasks":140,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":114,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:39.605Z","completionTime":"2016-10-10T21:40:39.938Z","stageIds":[201],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":113,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:39.349Z","completionTime":"2016-10-10T21:40:39.520Z","stageIds":[200],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":112,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:39.110Z","completionTime":"2016-10-10T21:40:39.240Z","stageIds":[199],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":111,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:35.599Z","completionTime":"2016-10-10T21:40:39.009Z","stageIds":[197,198],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":140,"numActiveTasks":0,"numCompletedTasks":140,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":110,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:35.084Z","completionTime":"2016-10-10T21:40:35.402Z","stageIds":[196],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":109,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:34.829Z","completionTime":"2016-10-10T21:40:35.030Z","stageIds":[195],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":108,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:34.607Z","completionTime":"2016-10-10T21:40:34.738Z","stageIds":[194],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":107,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:31.515Z","completionTime":"2016-10-10T21:40:34.504Z","stageIds":[192,193],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":140,"numActiveTasks":0,"numCompletedTasks":140,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":106,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:31.155Z","completionTime":"2016-10-10T21:40:31.361Z","stageIds":[191],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":105,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:30.985Z","completionTime":"2016-10-10T21:40:31.106Z","stageIds":[190],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":104,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:30.756Z","completionTime":"2016-10-10T21:40:30.882Z","stageIds":[189],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":103,"userName":"hive","name":"runJob at FileSinkOperator.scala:234","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:28.938Z","completionTime":"2016-10-10T21:40:29.096Z","stageIds":[188],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":102,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:28.412Z","completionTime":"2016-10-10T21:40:28.911Z","stageIds":[186,187],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":101,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:27.945Z","completionTime":"2016-10-10T21:40:29.355Z","stageIds":[184,185],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":13,"numActiveTasks":0,"numCompletedTasks":13,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":100,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:27.668Z","completionTime":"2016-10-10T21:40:28.330Z","stageIds":[183,182],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":99,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:27.499Z","completionTime":"2016-10-10T21:40:27.870Z","stageIds":[181],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":98,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:27.283Z","completionTime":"2016-10-10T21:40:27.473Z","stageIds":[180],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":97,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:27.116Z","completionTime":"2016-10-10T21:40:29.696Z","stageIds":[179,178],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":96,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:26.863Z","completionTime":"2016-10-10T21:40:27.042Z","stageIds":[177],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":95,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:26.856Z","completionTime":"2016-10-10T21:40:27.525Z","stageIds":[176,175],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":94,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.818Z","completionTime":"2016-10-10T21:40:27.260Z","stageIds":[174],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":93,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:26.562Z","completionTime":"2016-10-10T21:40:26.755Z","stageIds":[173],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":92,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.536Z","completionTime":"2016-10-10T21:40:27.609Z","stageIds":[171,172],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":9,"numActiveTasks":0,"numCompletedTasks":9,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":91,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.393Z","completionTime":"2016-10-10T21:40:26.793Z","stageIds":[170],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":90,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:26.250Z","completionTime":"2016-10-10T21:40:26.463Z","stageIds":[169],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":89,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:26.212Z","completionTime":"2016-10-10T21:40:26.675Z","stageIds":[168,167],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":88,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.011Z","completionTime":"2016-10-10T21:40:26.493Z","stageIds":[166],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":87,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:25.745Z","completionTime":"2016-10-10T21:40:26.334Z","stageIds":[165],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":86,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:25.709Z","completionTime":"2016-10-10T21:40:25.998Z","stageIds":[164],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":85,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:25.637Z","completionTime":"2016-10-10T21:40:26.140Z","stageIds":[162,163],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":84,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:25.385Z","completionTime":"2016-10-10T21:40:25.696Z","stageIds":[161],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":83,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:24.446Z","completionTime":"2016-10-10T21:40:25.591Z","stageIds":[159,160],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":82,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:22.770Z","completionTime":"2016-10-10T21:40:24.362Z","stageIds":[157,158],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":81,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:20.755Z","completionTime":"2016-10-10T21:40:22.654Z","stageIds":[155,156],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":80,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:17.775Z","completionTime":"2016-10-10T21:40:20.638Z","stageIds":[153,154],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":79,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:17.376Z","completionTime":"2016-10-10T21:40:18.488Z","stageIds":[151,152],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":10,"numActiveTasks":0,"numCompletedTasks":10,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":78,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:17.168Z","completionTime":"2016-10-10T21:40:25.344Z","stageIds":[150,147,144,148,145,149,146],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":526,"numActiveTasks":0,"numCompletedTasks":526,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":7,"numSkippedStages":0,"numFailedStages":0},{"jobId":77,"userName":"hive","name":"HiveRangePartitioner at RDDUtils.scala:146","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:17.025Z","completionTime":"2016-10-10T21:40:17.336Z","stageIds":[143],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":5,"numActiveTasks":0,"numCompletedTasks":5,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":76,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:16.750Z","completionTime":"2016-10-10T21:40:24.997Z","stageIds":[135,139,136,140,137,141,138,142,134],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":497,"numActiveTasks":0,"numCompletedTasks":497,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":9,"numSkippedStages":0,"numFailedStages":0},{"jobId":75,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:16.557Z","completionTime":"2016-10-10T21:40:16.960Z","stageIds":[133],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":5,"numActiveTasks":0,"numCompletedTasks":5,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":74,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:16.231Z","completionTime":"2016-10-10T21:40:16.550Z","stageIds":[132],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":73,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:16.164Z","completionTime":"2016-10-10T21:40:16.433Z","stageIds":[131],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":72,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:15.796Z","completionTime":"2016-10-10T21:40:16.005Z","stageIds":[130],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":71,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:15.742Z","completionTime":"2016-10-10T21:40:15.900Z","stageIds":[129],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":70,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:15.555Z","completionTime":"2016-10-10T21:40:17.114Z","stageIds":[128],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":69,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:14.759Z","completionTime":"2016-10-10T21:40:17.634Z","stageIds":[126,127],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":68,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:14.703Z","completionTime":"2016-10-10T21:40:16.403Z","stageIds":[125,124],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":3,"numActiveTasks":0,"numCompletedTasks":3,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":67,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:12.663Z","completionTime":"2016-10-10T21:40:14.644Z","stageIds":[122,123],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":66,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:12.642Z","completionTime":"2016-10-10T21:40:14.642Z","stageIds":[121],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":4,"numActiveTasks":0,"numCompletedTasks":4,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":65,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:10.665Z","completionTime":"2016-10-10T21:40:12.564Z","stageIds":[119,120],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":64,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:10.402Z","completionTime":"2016-10-10T21:40:10.631Z","stageIds":[118],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":63,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:10.292Z","completionTime":"2016-10-10T21:40:24.584Z","stageIds":[117,114,115,116],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":26,"numActiveTasks":0,"numCompletedTasks":26,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":4,"numSkippedStages":0,"numFailedStages":0},{"jobId":62,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:09.242Z","completionTime":"2016-10-10T21:40:15.439Z","stageIds":[113],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":61,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:08.396Z","completionTime":"2016-10-10T21:40:10.201Z","stageIds":[112],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":60,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:08.333Z","completionTime":"2016-10-10T21:40:25.540Z","stageIds":[111,109,110],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":59,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:08.190Z","completionTime":"2016-10-10T21:40:12.524Z","stageIds":[107,108],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":58,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:07.898Z","completionTime":"2016-10-10T21:40:08.292Z","stageIds":[106],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":57,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:07.657Z","completionTime":"2016-10-10T21:40:16.534Z","stageIds":[102,99,103,100,104,101,105,98],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":49,"numActiveTasks":0,"numCompletedTasks":49,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":8,"numSkippedStages":0,"numFailedStages":0},{"jobId":56,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:07.297Z","completionTime":"2016-10-10T21:40:24.743Z","stageIds":[96,97,95],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":17,"numActiveTasks":0,"numCompletedTasks":17,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":55,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:07.257Z","completionTime":"2016-10-10T21:40:08.224Z","stageIds":[93,94],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":54,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:07.230Z","completionTime":"2016-10-10T21:40:09.070Z","stageIds":[92],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":53,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:07.080Z","completionTime":"2016-10-10T21:40:07.472Z","stageIds":[91],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":52,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:06.648Z","completionTime":"2016-10-10T21:40:07.739Z","stageIds":[90],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":51,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:06.601Z","completionTime":"2016-10-10T21:40:07.075Z","stageIds":[89],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":50,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:40:06.563Z","completionTime":"2016-10-10T21:40:16.792Z","stageIds":[88,85,86,87],"jobGroup":"hive_20161010213939_1d38c432-6d6c-4893-b9e4-4db016cf2e3e","status":"succeeded","numTasks":100,"numActiveTasks":0,"numCompletedTasks":100,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":4,"numSkippedStages":0,"numFailedStages":0},{"jobId":49,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wswscs STORED AS ORC AS select /*+MAPJOIN(date_dim)*/ d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq","submissionTime":"2016-10-10T21:40:06.331Z","completionTime":"2016-10-10T21:40:15.015Z","stageIds":[84,83],"jobGroup":"hive_20161010214040_d4d23f9c-10a0-4bf0-8328-32954a8e8ed5","status":"succeeded","numTasks":13,"numActiveTasks":0,"numCompletedTasks":13,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":48,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:06.249Z","completionTime":"2016-10-10T21:40:07.038Z","stageIds":[82],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":47,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:06.209Z","completionTime":"2016-10-10T21:40:06.449Z","stageIds":[81],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":46,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:06.156Z","completionTime":"2016-10-10T21:40:06.907Z","stageIds":[80],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":45,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:06.108Z","completionTime":"2016-10-10T21:40:13.924Z","stageIds":[78,79,77],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":44,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:06.056Z","completionTime":"2016-10-10T21:40:06.441Z","stageIds":[76],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":43,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:05.911Z","completionTime":"2016-10-10T21:40:06.097Z","stageIds":[75],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":42,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:05.866Z","completionTime":"2016-10-10T21:40:07.181Z","stageIds":[74],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":41,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:05.631Z","completionTime":"2016-10-10T21:40:05.942Z","stageIds":[73],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":40,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:05.546Z","completionTime":"2016-10-10T21:40:05.902Z","stageIds":[72],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":39,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:04.979Z","completionTime":"2016-10-10T21:40:05.950Z","stageIds":[71],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":38,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wswscs STORED AS ORC AS select /*+MAPJOIN(date_dim)*/ d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq","submissionTime":"2016-10-10T21:40:04.944Z","completionTime":"2016-10-10T21:40:06.202Z","stageIds":[70],"jobGroup":"hive_20161010214040_d4d23f9c-10a0-4bf0-8328-32954a8e8ed5","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":37,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:04.681Z","completionTime":"2016-10-10T21:40:05.326Z","stageIds":[69],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":36,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:04.493Z","completionTime":"2016-10-10T21:40:07.989Z","stageIds":[67,68],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":35,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:04.429Z","completionTime":"2016-10-10T21:40:04.818Z","stageIds":[66],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":34,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:04.343Z","completionTime":"2016-10-10T21:40:04.590Z","stageIds":[65],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":33,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:04.007Z","completionTime":"2016-10-10T21:40:04.231Z","stageIds":[64],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":32,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:40:03.873Z","completionTime":"2016-10-10T21:40:12.583Z","stageIds":[63,60,56,53,57,54,61,58,55,62,59],"jobGroup":"hive_20161010213939_e8648f83-fc3e-4ef6-9695-b8619cc041f9","status":"succeeded","numTasks":39,"numActiveTasks":0,"numCompletedTasks":39,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":11,"numSkippedStages":0,"numFailedStages":0},{"jobId":31,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:03.626Z","completionTime":"2016-10-10T21:40:05.742Z","stageIds":[52],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":30,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:03.493Z","completionTime":"2016-10-10T21:40:03.748Z","stageIds":[51],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":29,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:40:03.272Z","completionTime":"2016-10-10T21:40:06.370Z","stageIds":[50],"jobGroup":"hive_20161010213939_1d38c432-6d6c-4893-b9e4-4db016cf2e3e","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":28,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:03.196Z","completionTime":"2016-10-10T21:40:04.310Z","stageIds":[49],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":27,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:40:03.143Z","completionTime":"2016-10-10T21:40:03.686Z","stageIds":[48],"jobGroup":"hive_20161010213939_e8648f83-fc3e-4ef6-9695-b8619cc041f9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":26,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:03.060Z","completionTime":"2016-10-10T21:40:03.355Z","stageIds":[47],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":25,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:02.635Z","completionTime":"2016-10-10T21:40:05.528Z","stageIds":[46],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":24,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:02.536Z","completionTime":"2016-10-10T21:40:05.728Z","stageIds":[45],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":23,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:40:02.434Z","completionTime":"2016-10-10T21:40:08.229Z","stageIds":[42,43,44],"jobGroup":"hive_20161010213939_fb6ebee0-9db4-41f4-891a-e66122c67eb6","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":22,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:02.134Z","completionTime":"2016-10-10T21:40:05.905Z","stageIds":[41],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":21,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_customer_total_return STORED AS ORC AS select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return\n    from store_returns,date_dim\n    where sr_returned_date_sk = d_date_sk and d_year =2000\n    group by sr_customer_sk,sr_store_sk","submissionTime":"2016-10-10T21:40:01.878Z","completionTime":"2016-10-10T21:40:09.492Z","stageIds":[39,40],"jobGroup":"hive_20161010213939_09683529-e037-423a-a290-61db5d2ffc03","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":20,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:01.713Z","completionTime":"2016-10-10T21:40:04.422Z","stageIds":[37,38],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":19,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim) */\n       ca_zip\n       ,sum(cs_sales_price)\n from catalog_sales\n     JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n     JOIN (select ca_zip, ca_state, c_customer_sk\n             from customer JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n          ) x\n     ON catalog_sales.cs_bill_customer_sk = x.c_customer_sk\n  where\n        ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n                                   '85392', '85460', '80348', '81792')\n              or ca_state in ('CA','WA','GA')\n              or cs_sales_price > 500)\n        and d_qoy = 2 and d_year = 2000\n group by ca_zip\n order by ca_zip\n limit 100","submissionTime":"2016-10-10T21:40:01.495Z","completionTime":"2016-10-10T21:40:16.260Z","stageIds":[33,30,34,31,35,32,36],"jobGroup":"hive_20161010213939_016b5f69-08c4-42b2-aea4-21c065f872ab","status":"succeeded","numTasks":160,"numActiveTasks":0,"numCompletedTasks":160,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":7,"numSkippedStages":0,"numFailedStages":0},{"jobId":18,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:01.449Z","completionTime":"2016-10-10T21:40:15.540Z","stageIds":[29],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":17,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim ) */\n avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost)\n from store_sales\n     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk\n     JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk\n     JOIN household_demographics ON store_sales.ss_hdemo_sk=household_demographics.hd_demo_sk\n     JOIN store ON store.s_store_sk = store_sales.ss_store_sk\n where\n d_year = 2001\n and((\n  cd_marital_status = 'M'\n  and cd_education_status = '4 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (\n  cd_marital_status = 'D'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (\n  cd_marital_status = 'U'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((\n  ca_country = 'United States'\n  and ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 250  \n     ))","submissionTime":"2016-10-10T21:40:01.373Z","completionTime":"2016-10-10T21:40:13.981Z","stageIds":[27,19,20,24,21,28,25,22,26,23],"jobGroup":"hive_20161010213939_ce8ef292-2595-4695-8b31-a2166386751b","status":"succeeded","numTasks":207,"numActiveTasks":0,"numCompletedTasks":207,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":10,"numSkippedStages":0,"numFailedStages":0},{"jobId":16,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:40:01.155Z","completionTime":"2016-10-10T21:40:02.039Z","stageIds":[18],"jobGroup":"hive_20161010213939_fb6ebee0-9db4-41f4-891a-e66122c67eb6","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":15,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:01.016Z","completionTime":"2016-10-10T21:40:03.324Z","stageIds":[17],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":14,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:39:54.318Z","completionTime":"2016-10-10T21:40:02.622Z","stageIds":[16],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":13,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:39:53.845Z","completionTime":"2016-10-10T21:40:02.107Z","stageIds":[15],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":12,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:39:53.624Z","completionTime":"2016-10-10T21:40:01.346Z","stageIds":[14],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":11,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:39:53.517Z","completionTime":"2016-10-10T21:40:01.681Z","stageIds":[13],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":10,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim ) */\n avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost)\n from store_sales\n     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk\n     JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk\n     JOIN household_demographics ON store_sales.ss_hdemo_sk=household_demographics.hd_demo_sk\n     JOIN store ON store.s_store_sk = store_sales.ss_store_sk\n where\n d_year = 2001\n and((\n  cd_marital_status = 'M'\n  and cd_education_status = '4 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (\n  cd_marital_status = 'D'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (\n  cd_marital_status = 'U'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((\n  ca_country = 'United States'\n  and ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 250  \n     ))","submissionTime":"2016-10-10T21:39:53.264Z","completionTime":"2016-10-10T21:40:00.946Z","stageIds":[12],"jobGroup":"hive_20161010213939_ce8ef292-2595-4695-8b31-a2166386751b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":9,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:39:53.202Z","completionTime":"2016-10-10T21:40:02.080Z","stageIds":[10,11],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":8,"userName":"hive","name":"runJob at FileSinkOperator.scala:234","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wscs STORED AS ORC AS select sold_date_sk\n        ,sales_price\n  from (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n          from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales) x","submissionTime":"2016-10-10T21:39:53.142Z","completionTime":"2016-10-10T21:40:04.376Z","stageIds":[9],"jobGroup":"hive_20161010213939_2beea94b-fab6-4a01-b3d5-8405ff130a5a","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":7,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:39:53.094Z","completionTime":"2016-10-10T21:40:00.897Z","stageIds":[8],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":6,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:39:53.055Z","completionTime":"2016-10-10T21:40:02.703Z","stageIds":[7],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":5,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:39:52.939Z","completionTime":"2016-10-10T21:40:02.768Z","stageIds":[6],"jobGroup":"hive_20161010213939_1d38c432-6d6c-4893-b9e4-4db016cf2e3e","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":4,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_customer_total_return STORED AS ORC AS select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return\n    from store_returns,date_dim\n    where sr_returned_date_sk = d_date_sk and d_year =2000\n    group by sr_customer_sk,sr_store_sk","submissionTime":"2016-10-10T21:39:52.903Z","completionTime":"2016-10-10T21:40:01.688Z","stageIds":[5],"jobGroup":"hive_20161010213939_09683529-e037-423a-a290-61db5d2ffc03","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":3,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:39:52.849Z","completionTime":"2016-10-10T21:40:02.090Z","stageIds":[4],"jobGroup":"hive_20161010213939_e8648f83-fc3e-4ef6-9695-b8619cc041f9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":2,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:39:52.811Z","completionTime":"2016-10-10T21:40:01.096Z","stageIds":[3],"jobGroup":"hive_20161010213939_fb6ebee0-9db4-41f4-891a-e66122c67eb6","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":1,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim) */\n       ca_zip\n       ,sum(cs_sales_price)\n from catalog_sales\n     JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n     JOIN (select ca_zip, ca_state, c_customer_sk\n             from customer JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n          ) x\n     ON catalog_sales.cs_bill_customer_sk = x.c_customer_sk\n  where\n        ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n                                   '85392', '85460', '80348', '81792')\n              or ca_state in ('CA','WA','GA')\n              or cs_sales_price > 500)\n        and d_qoy = 2 and d_year = 2000\n group by ca_zip\n order by ca_zip\n limit 100","submissionTime":"2016-10-10T21:39:52.760Z","completionTime":"2016-10-10T21:40:01.248Z","stageIds":[2],"jobGroup":"hive_20161010213939_016b5f69-08c4-42b2-aea4-21c065f872ab","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":0,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:39:52.611Z","completionTime":"2016-10-10T21:40:01.558Z","stageIds":[0,1],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0}]