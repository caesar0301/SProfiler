[{"jobId":264,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:23.113Z","completionTime":"2016-10-10T21:53:24.806Z","stageIds":[466,463,467,464,468,465],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":207,"numActiveTasks":0,"numCompletedTasks":207,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":6,"numSkippedStages":0,"numFailedStages":0},{"jobId":263,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:22.259Z","completionTime":"2016-10-10T21:53:22.975Z","stageIds":[462,461],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":50,"numActiveTasks":0,"numCompletedTasks":50,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":262,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:21.914Z","completionTime":"2016-10-10T21:53:22.142Z","stageIds":[460],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":261,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:21.576Z","completionTime":"2016-10-10T21:53:21.840Z","stageIds":[459],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":260,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:21.331Z","completionTime":"2016-10-10T21:53:21.500Z","stageIds":[458],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":259,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:20.488Z","completionTime":"2016-10-10T21:53:21.191Z","stageIds":[456,457],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":50,"numActiveTasks":0,"numCompletedTasks":50,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":258,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:20.165Z","completionTime":"2016-10-10T21:53:20.374Z","stageIds":[455],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":257,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:19.877Z","completionTime":"2016-10-10T21:53:20.092Z","stageIds":[454],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":256,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:19.633Z","completionTime":"2016-10-10T21:53:19.803Z","stageIds":[453],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":255,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:18.738Z","completionTime":"2016-10-10T21:53:19.491Z","stageIds":[452,451],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":50,"numActiveTasks":0,"numCompletedTasks":50,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":254,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:18.415Z","completionTime":"2016-10-10T21:53:18.621Z","stageIds":[450],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":253,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:18.097Z","completionTime":"2016-10-10T21:53:18.342Z","stageIds":[449],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":252,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:53:17.886Z","completionTime":"2016-10-10T21:53:18.048Z","stageIds":[448],"jobGroup":"hive_20161010215353_2aa31cf2-0bc3-4664-b7a4-0ec1ce46c0ba","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":251,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:51.223Z","completionTime":"2016-10-10T21:52:53.015Z","stageIds":[444,445,442,446,443,447],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":207,"numActiveTasks":0,"numCompletedTasks":207,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":6,"numSkippedStages":0,"numFailedStages":0},{"jobId":250,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:50.313Z","completionTime":"2016-10-10T21:52:51.086Z","stageIds":[440,441],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":50,"numActiveTasks":0,"numCompletedTasks":50,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":249,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:49.925Z","completionTime":"2016-10-10T21:52:50.198Z","stageIds":[439],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":248,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:49.632Z","completionTime":"2016-10-10T21:52:49.851Z","stageIds":[438],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":247,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:49.402Z","completionTime":"2016-10-10T21:52:49.560Z","stageIds":[437],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":246,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:48.528Z","completionTime":"2016-10-10T21:52:49.261Z","stageIds":[435,436],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":50,"numActiveTasks":0,"numCompletedTasks":50,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":245,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:48.169Z","completionTime":"2016-10-10T21:52:48.406Z","stageIds":[434],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":244,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:47.869Z","completionTime":"2016-10-10T21:52:48.080Z","stageIds":[433],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":243,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:47.624Z","completionTime":"2016-10-10T21:52:47.798Z","stageIds":[432],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":242,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:46.671Z","completionTime":"2016-10-10T21:52:47.483Z","stageIds":[430,431],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":50,"numActiveTasks":0,"numCompletedTasks":50,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":241,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:46.280Z","completionTime":"2016-10-10T21:52:46.554Z","stageIds":[429],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":240,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:45.957Z","completionTime":"2016-10-10T21:52:46.206Z","stageIds":[428],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":239,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ss as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith cs as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\nwith ws as (\n select\n       /*+MAPJOIN(date_dim,customer_address,item)*/\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Children'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 1999\n and     d_moy                   = 9\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\nselect   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\nlimit 100","submissionTime":"2016-10-10T21:52:45.693Z","completionTime":"2016-10-10T21:52:45.882Z","stageIds":[427],"jobGroup":"hive_20161010215252_a90a5b73-5647-4ba3-abba-8f3cf0401657","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":238,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select\n   /*+MAPJOIN(warehouse ,ship_mode ,call_center ,date_dim)*/  \n   substr(w_warehouse_name,1,20) sub_warehouse\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as 30days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as 3160days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as 6190days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as 91120days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as 120days \nfrom\n   catalog_sales\n  ,date_dim\n  ,warehouse\n  ,ship_mode\n  ,call_center\nwhere\n    d_month_seq between 1212 and 1212 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substr(w_warehouse_name,1,20)\n  ,w_warehouse_name\n  ,sm_type\n  ,cc_name\norder by \n--         substr(w_warehouse_name,1,20)\n         sub_warehouse\n        ,sm_type\n        ,cc_name\nlimit 100","submissionTime":"2016-10-10T21:50:32.817Z","completionTime":"2016-10-10T21:50:35.533Z","stageIds":[425,426,424],"jobGroup":"hive_20161010215050_27689975-2030-4779-86b6-b35440c7a733","status":"succeeded","numTasks":54,"numActiveTasks":0,"numCompletedTasks":54,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":237,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select\n   /*+MAPJOIN(warehouse ,ship_mode ,call_center ,date_dim)*/  \n   substr(w_warehouse_name,1,20) sub_warehouse\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as 30days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as 3160days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as 6190days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as 91120days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as 120days \nfrom\n   catalog_sales\n  ,date_dim\n  ,warehouse\n  ,ship_mode\n  ,call_center\nwhere\n    d_month_seq between 1212 and 1212 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substr(w_warehouse_name,1,20)\n  ,w_warehouse_name\n  ,sm_type\n  ,cc_name\norder by \n--         substr(w_warehouse_name,1,20)\n         sub_warehouse\n        ,sm_type\n        ,cc_name\nlimit 100","submissionTime":"2016-10-10T21:50:32.528Z","completionTime":"2016-10-10T21:50:32.731Z","stageIds":[423],"jobGroup":"hive_20161010215050_27689975-2030-4779-86b6-b35440c7a733","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":236,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select\n   /*+MAPJOIN(warehouse ,ship_mode ,call_center ,date_dim)*/  \n   substr(w_warehouse_name,1,20) sub_warehouse\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as 30days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as 3160days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as 6190days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as 91120days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as 120days \nfrom\n   catalog_sales\n  ,date_dim\n  ,warehouse\n  ,ship_mode\n  ,call_center\nwhere\n    d_month_seq between 1212 and 1212 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substr(w_warehouse_name,1,20)\n  ,w_warehouse_name\n  ,sm_type\n  ,cc_name\norder by \n--         substr(w_warehouse_name,1,20)\n         sub_warehouse\n        ,sm_type\n        ,cc_name\nlimit 100","submissionTime":"2016-10-10T21:50:32.242Z","completionTime":"2016-10-10T21:50:32.454Z","stageIds":[422],"jobGroup":"hive_20161010215050_27689975-2030-4779-86b6-b35440c7a733","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":235,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select\n   /*+MAPJOIN(warehouse ,ship_mode ,call_center ,date_dim)*/  \n   substr(w_warehouse_name,1,20) sub_warehouse\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as 30days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as 3160days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as 6190days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as 91120days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as 120days \nfrom\n   catalog_sales\n  ,date_dim\n  ,warehouse\n  ,ship_mode\n  ,call_center\nwhere\n    d_month_seq between 1212 and 1212 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substr(w_warehouse_name,1,20)\n  ,w_warehouse_name\n  ,sm_type\n  ,cc_name\norder by \n--         substr(w_warehouse_name,1,20)\n         sub_warehouse\n        ,sm_type\n        ,cc_name\nlimit 100","submissionTime":"2016-10-10T21:50:31.956Z","completionTime":"2016-10-10T21:50:32.169Z","stageIds":[421],"jobGroup":"hive_20161010215050_27689975-2030-4779-86b6-b35440c7a733","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":234,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select\n   /*+MAPJOIN(warehouse ,ship_mode ,call_center ,date_dim)*/  \n   substr(w_warehouse_name,1,20) sub_warehouse\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as 30days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as 3160days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as 6190days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as 91120days \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as 120days \nfrom\n   catalog_sales\n  ,date_dim\n  ,warehouse\n  ,ship_mode\n  ,call_center\nwhere\n    d_month_seq between 1212 and 1212 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substr(w_warehouse_name,1,20)\n  ,w_warehouse_name\n  ,sm_type\n  ,cc_name\norder by \n--         substr(w_warehouse_name,1,20)\n         sub_warehouse\n        ,sm_type\n        ,cc_name\nlimit 100","submissionTime":"2016-10-10T21:50:31.651Z","completionTime":"2016-10-10T21:50:31.881Z","stageIds":[420],"jobGroup":"hive_20161010215050_27689975-2030-4779-86b6-b35440c7a733","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":233,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:38.749Z","completionTime":"2016-10-10T21:48:42.566Z","stageIds":[419,416,417,414,418,415],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":523,"numActiveTasks":0,"numCompletedTasks":523,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":6,"numSkippedStages":0,"numFailedStages":0},{"jobId":232,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:35.865Z","completionTime":"2016-10-10T21:48:38.598Z","stageIds":[412,413],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":139,"numActiveTasks":0,"numCompletedTasks":139,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":231,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:35.379Z","completionTime":"2016-10-10T21:48:35.704Z","stageIds":[411],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":230,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:35.137Z","completionTime":"2016-10-10T21:48:35.299Z","stageIds":[410],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":229,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:34.910Z","completionTime":"2016-10-10T21:48:35.035Z","stageIds":[409],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":228,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:31.820Z","completionTime":"2016-10-10T21:48:34.819Z","stageIds":[407,408],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":139,"numActiveTasks":0,"numCompletedTasks":139,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":227,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:31.335Z","completionTime":"2016-10-10T21:48:31.654Z","stageIds":[406],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":226,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:31.092Z","completionTime":"2016-10-10T21:48:31.254Z","stageIds":[405],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":225,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:30.865Z","completionTime":"2016-10-10T21:48:30.987Z","stageIds":[404],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":224,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:27.643Z","completionTime":"2016-10-10T21:48:30.776Z","stageIds":[402,403],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":139,"numActiveTasks":0,"numCompletedTasks":139,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":223,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:27.153Z","completionTime":"2016-10-10T21:48:27.480Z","stageIds":[401],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":222,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:26.918Z","completionTime":"2016-10-10T21:48:27.071Z","stageIds":[400],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":221,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:48:26.638Z","completionTime":"2016-10-10T21:48:26.768Z","stageIds":[399],"jobGroup":"hive_20161010214848_1909d714-8352-4ce6-8e4d-21a14532192d","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":220,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:25.314Z","completionTime":"2016-10-10T21:48:26.300Z","stageIds":[397,398],"jobGroup":"hive_20161010214848_c1ecec4d-6a09-4eab-801e-63006421807d","status":"succeeded","numTasks":9,"numActiveTasks":0,"numCompletedTasks":9,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":219,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:24.985Z","completionTime":"2016-10-10T21:48:25.256Z","stageIds":[396],"jobGroup":"hive_20161010214848_c1ecec4d-6a09-4eab-801e-63006421807d","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":218,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:24.737Z","completionTime":"2016-10-10T21:48:24.957Z","stageIds":[395],"jobGroup":"hive_20161010214848_c1ecec4d-6a09-4eab-801e-63006421807d","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":217,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:24.423Z","completionTime":"2016-10-10T21:48:24.715Z","stageIds":[394],"jobGroup":"hive_20161010214848_c1ecec4d-6a09-4eab-801e-63006421807d","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":216,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:23.496Z","completionTime":"2016-10-10T21:48:24.947Z","stageIds":[393,392],"jobGroup":"hive_20161010214848_cf735639-19ce-424b-8125-4eca7e9ebda2","status":"succeeded","numTasks":13,"numActiveTasks":0,"numCompletedTasks":13,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":215,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:23.136Z","completionTime":"2016-10-10T21:48:23.438Z","stageIds":[391],"jobGroup":"hive_20161010214848_cf735639-19ce-424b-8125-4eca7e9ebda2","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":214,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:48:22.918Z","completionTime":"2016-10-10T21:48:25.101Z","stageIds":[389,390],"jobGroup":"hive_20161010214848_781c1a03-2561-4708-8632-5c9499055fdb","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":213,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:22.755Z","completionTime":"2016-10-10T21:48:23.114Z","stageIds":[388],"jobGroup":"hive_20161010214848_cf735639-19ce-424b-8125-4eca7e9ebda2","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":212,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:48:22.625Z","completionTime":"2016-10-10T21:48:22.834Z","stageIds":[387],"jobGroup":"hive_20161010214848_781c1a03-2561-4708-8632-5c9499055fdb","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":211,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:48:22.406Z","completionTime":"2016-10-10T21:48:22.566Z","stageIds":[386],"jobGroup":"hive_20161010214848_781c1a03-2561-4708-8632-5c9499055fdb","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":210,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:48:22.177Z","completionTime":"2016-10-10T21:48:22.343Z","stageIds":[385],"jobGroup":"hive_20161010214848_781c1a03-2561-4708-8632-5c9499055fdb","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":209,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:22.168Z","completionTime":"2016-10-10T21:48:22.742Z","stageIds":[384],"jobGroup":"hive_20161010214848_cf735639-19ce-424b-8125-4eca7e9ebda2","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":208,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:21.543Z","completionTime":"2016-10-10T21:48:22.156Z","stageIds":[383],"jobGroup":"hive_20161010214848_cf735639-19ce-424b-8125-4eca7e9ebda2","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":207,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:48:21.054Z","completionTime":"2016-10-10T21:48:21.529Z","stageIds":[382],"jobGroup":"hive_20161010214848_cf735639-19ce-424b-8125-4eca7e9ebda2","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":206,"userName":"hive","name":"runJob at FileSinkOperator.scala:234","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:20.983Z","completionTime":"2016-10-10T21:48:21.116Z","stageIds":[381],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":205,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:20.210Z","completionTime":"2016-10-10T21:48:20.916Z","stageIds":[379,380],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":204,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:19.352Z","completionTime":"2016-10-10T21:48:20.033Z","stageIds":[377,378],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":203,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:18.410Z","completionTime":"2016-10-10T21:48:19.146Z","stageIds":[375,376],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":202,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:17.578Z","completionTime":"2016-10-10T21:48:18.267Z","stageIds":[374,373],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":201,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:48:17.403Z","completionTime":"2016-10-10T21:48:21.868Z","stageIds":[371,368,372,369,365,366,370,367,364],"jobGroup":"hive_20161010214848_8a46473f-af1b-45ce-b886-36495d90debc","status":"succeeded","numTasks":497,"numActiveTasks":0,"numCompletedTasks":497,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":9,"numSkippedStages":0,"numFailedStages":0},{"jobId":200,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:48:17.127Z","completionTime":"2016-10-10T21:48:17.291Z","stageIds":[363],"jobGroup":"hive_20161010214848_8a46473f-af1b-45ce-b886-36495d90debc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":199,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:16.946Z","completionTime":"2016-10-10T21:48:17.433Z","stageIds":[361,362],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":198,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:48:16.784Z","completionTime":"2016-10-10T21:48:16.922Z","stageIds":[360],"jobGroup":"hive_20161010214848_8a46473f-af1b-45ce-b886-36495d90debc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":197,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:16.413Z","completionTime":"2016-10-10T21:48:16.877Z","stageIds":[358,359],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":196,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:15.749Z","completionTime":"2016-10-10T21:48:16.326Z","stageIds":[356,357],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":195,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:14.925Z","completionTime":"2016-10-10T21:48:15.587Z","stageIds":[354,355],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":194,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:14.758Z","completionTime":"2016-10-10T21:48:23.251Z","stageIds":[353,351,352],"jobGroup":"hive_20161010214848_1d94bb8e-d97d-4542-88d3-b373bf0321ec","status":"succeeded","numTasks":17,"numActiveTasks":0,"numCompletedTasks":17,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":193,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:14.400Z","completionTime":"2016-10-10T21:48:21.349Z","stageIds":[350,347,344,348,345,349,346],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":526,"numActiveTasks":0,"numCompletedTasks":526,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":7,"numSkippedStages":0,"numFailedStages":0},{"jobId":192,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:14.081Z","completionTime":"2016-10-10T21:48:14.362Z","stageIds":[343],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":191,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:14.065Z","completionTime":"2016-10-10T21:48:14.806Z","stageIds":[342,341],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":190,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:13.551Z","completionTime":"2016-10-10T21:48:13.904Z","stageIds":[340],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":189,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:48:13.490Z","completionTime":"2016-10-10T21:48:14.185Z","stageIds":[338,339],"jobGroup":"hive_20161010214848_4a3f6bca-b1d2-4461-a1c0-750c3a3648f2","status":"succeeded","numTasks":10,"numActiveTasks":0,"numCompletedTasks":10,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":188,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:13.140Z","completionTime":"2016-10-10T21:48:18.778Z","stageIds":[335,336,337,334],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":26,"numActiveTasks":0,"numCompletedTasks":26,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":4,"numSkippedStages":0,"numFailedStages":0},{"jobId":187,"userName":"hive","name":"HiveRangePartitioner at RDDUtils.scala:146","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:48:13.097Z","completionTime":"2016-10-10T21:48:13.442Z","stageIds":[333],"jobGroup":"hive_20161010214848_4a3f6bca-b1d2-4461-a1c0-750c3a3648f2","status":"succeeded","numTasks":5,"numActiveTasks":0,"numCompletedTasks":5,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":186,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:12.965Z","completionTime":"2016-10-10T21:48:13.453Z","stageIds":[332],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":185,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:48:12.823Z","completionTime":"2016-10-10T21:48:13.078Z","stageIds":[331],"jobGroup":"hive_20161010214848_4a3f6bca-b1d2-4461-a1c0-750c3a3648f2","status":"succeeded","numTasks":5,"numActiveTasks":0,"numCompletedTasks":5,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":184,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:12.774Z","completionTime":"2016-10-10T21:48:15.792Z","stageIds":[324,328,325,329,326,323,330,327],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":49,"numActiveTasks":0,"numCompletedTasks":49,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":8,"numSkippedStages":0,"numFailedStages":0},{"jobId":183,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:48:12.683Z","completionTime":"2016-10-10T21:48:13.645Z","stageIds":[321,322],"jobGroup":"hive_20161010214848_737239c2-0e6d-4f4e-8025-a84f96a99dc0","status":"succeeded","numTasks":3,"numActiveTasks":0,"numCompletedTasks":3,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":182,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:48:12.546Z","completionTime":"2016-10-10T21:48:12.746Z","stageIds":[320],"jobGroup":"hive_20161010214848_4a3f6bca-b1d2-4461-a1c0-750c3a3648f2","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":181,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:12.531Z","completionTime":"2016-10-10T21:48:12.661Z","stageIds":[319],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":180,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:12.458Z","completionTime":"2016-10-10T21:48:13.978Z","stageIds":[317,318],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":179,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:12.207Z","completionTime":"2016-10-10T21:48:12.847Z","stageIds":[316],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":178,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:12.122Z","completionTime":"2016-10-10T21:48:12.323Z","stageIds":[315],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":177,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:12.079Z","completionTime":"2016-10-10T21:48:13.090Z","stageIds":[314],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":176,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:48:11.998Z","completionTime":"2016-10-10T21:48:12.329Z","stageIds":[313],"jobGroup":"hive_20161010214848_4a3f6bca-b1d2-4461-a1c0-750c3a3648f2","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":175,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:11.948Z","completionTime":"2016-10-10T21:48:14.674Z","stageIds":[312],"jobGroup":"hive_20161010214848_1d94bb8e-d97d-4542-88d3-b373bf0321ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":174,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:48:11.842Z","completionTime":"2016-10-10T21:48:12.597Z","stageIds":[311],"jobGroup":"hive_20161010214848_737239c2-0e6d-4f4e-8025-a84f96a99dc0","status":"succeeded","numTasks":4,"numActiveTasks":0,"numCompletedTasks":4,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":173,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:11.769Z","completionTime":"2016-10-10T21:48:12.056Z","stageIds":[310],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":172,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:11.734Z","completionTime":"2016-10-10T21:48:11.939Z","stageIds":[309],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":171,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:11.681Z","completionTime":"2016-10-10T21:48:11.889Z","stageIds":[308],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":170,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:11.561Z","completionTime":"2016-10-10T21:48:18.477Z","stageIds":[305,306,307],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":169,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:48:11.294Z","completionTime":"2016-10-10T21:48:11.662Z","stageIds":[303,304],"jobGroup":"hive_20161010214848_737239c2-0e6d-4f4e-8025-a84f96a99dc0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":168,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:48:11.159Z","completionTime":"2016-10-10T21:48:14.110Z","stageIds":[302,300,301],"jobGroup":"hive_20161010214848_7c59d516-ebb9-42bd-a59a-20ff4df2a60f","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":167,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:11.046Z","completionTime":"2016-10-10T21:48:11.387Z","stageIds":[299,298],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":166,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:48:11.007Z","completionTime":"2016-10-10T21:48:11.264Z","stageIds":[297],"jobGroup":"hive_20161010214848_737239c2-0e6d-4f4e-8025-a84f96a99dc0","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":165,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:10.827Z","completionTime":"2016-10-10T21:48:11.193Z","stageIds":[296],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":164,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:10.799Z","completionTime":"2016-10-10T21:48:12.346Z","stageIds":[294,295],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":163,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:48:10.775Z","completionTime":"2016-10-10T21:48:11.107Z","stageIds":[293],"jobGroup":"hive_20161010214848_7c59d516-ebb9-42bd-a59a-20ff4df2a60f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":162,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:10.606Z","completionTime":"2016-10-10T21:48:11.365Z","stageIds":[292],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":161,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:48:10.470Z","completionTime":"2016-10-10T21:48:10.678Z","stageIds":[291],"jobGroup":"hive_20161010214848_7c59d516-ebb9-42bd-a59a-20ff4df2a60f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":160,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:10.447Z","completionTime":"2016-10-10T21:48:10.675Z","stageIds":[290],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":159,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:10.408Z","completionTime":"2016-10-10T21:48:10.971Z","stageIds":[289],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":158,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:10.263Z","completionTime":"2016-10-10T21:48:11.798Z","stageIds":[288],"jobGroup":"hive_20161010214848_1d94bb8e-d97d-4542-88d3-b373bf0321ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":157,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:10.229Z","completionTime":"2016-10-10T21:48:10.485Z","stageIds":[287],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":156,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:10.127Z","completionTime":"2016-10-10T21:48:10.712Z","stageIds":[285,286],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":155,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:10.060Z","completionTime":"2016-10-10T21:48:10.275Z","stageIds":[284],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":154,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:09.898Z","completionTime":"2016-10-10T21:48:10.321Z","stageIds":[283],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":153,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:48:09.641Z","completionTime":"2016-10-10T21:48:13.614Z","stageIds":[281,282,279,280],"jobGroup":"hive_20161010214848_c283c323-4233-465f-bf6f-837e0c17f9d2","status":"succeeded","numTasks":100,"numActiveTasks":0,"numCompletedTasks":100,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":4,"numSkippedStages":0,"numFailedStages":0},{"jobId":152,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:48:09.576Z","completionTime":"2016-10-10T21:48:16.667Z","stageIds":[278],"jobGroup":"hive_20161010214848_8a46473f-af1b-45ce-b886-36495d90debc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":151,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:09.458Z","completionTime":"2016-10-10T21:48:09.859Z","stageIds":[277],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":150,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:09.382Z","completionTime":"2016-10-10T21:48:10.022Z","stageIds":[275,276],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":149,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:09.272Z","completionTime":"2016-10-10T21:48:11.267Z","stageIds":[274],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":148,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wswscs STORED AS ORC AS select /*+MAPJOIN(date_dim)*/ d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq","submissionTime":"2016-10-10T21:48:09.256Z","completionTime":"2016-10-10T21:48:11.269Z","stageIds":[273,272],"jobGroup":"hive_20161010214848_a515d728-3d2c-418c-8c04-546acda1064a","status":"succeeded","numTasks":13,"numActiveTasks":0,"numCompletedTasks":13,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":147,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:09.174Z","completionTime":"2016-10-10T21:48:09.807Z","stageIds":[271],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":146,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:48:09.152Z","completionTime":"2016-10-10T21:48:10.404Z","stageIds":[270],"jobGroup":"hive_20161010214848_7c59d516-ebb9-42bd-a59a-20ff4df2a60f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":145,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:48:09.083Z","completionTime":"2016-10-10T21:48:09.492Z","stageIds":[269],"jobGroup":"hive_20161010214848_8a46473f-af1b-45ce-b886-36495d90debc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":144,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:09.056Z","completionTime":"2016-10-10T21:48:09.342Z","stageIds":[268],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":143,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim ) */\n avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost)\n from store_sales\n     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk\n     JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk\n     JOIN household_demographics ON store_sales.ss_hdemo_sk=household_demographics.hd_demo_sk\n     JOIN store ON store.s_store_sk = store_sales.ss_store_sk\n where\n d_year = 2001\n and((\n  cd_marital_status = 'M'\n  and cd_education_status = '4 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (\n  cd_marital_status = 'D'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (\n  cd_marital_status = 'U'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((\n  ca_country = 'United States'\n  and ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 250  \n     ))","submissionTime":"2016-10-10T21:48:09.028Z","completionTime":"2016-10-10T21:48:17.167Z","stageIds":[266,263,267,259,260,264,261,258,265,262],"jobGroup":"hive_20161010214848_8b748e19-df3b-4847-bccf-836e45adc6e5","status":"succeeded","numTasks":207,"numActiveTasks":0,"numCompletedTasks":207,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":10,"numSkippedStages":0,"numFailedStages":0},{"jobId":142,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim) */\n       ca_zip\n       ,sum(cs_sales_price)\n from catalog_sales\n     JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n     JOIN (select ca_zip, ca_state, c_customer_sk\n             from customer JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n          ) x\n     ON catalog_sales.cs_bill_customer_sk = x.c_customer_sk\n  where\n        ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n                                   '85392', '85460', '80348', '81792')\n              or ca_state in ('CA','WA','GA')\n              or cs_sales_price > 500)\n        and d_qoy = 2 and d_year = 2000\n group by ca_zip\n order by ca_zip\n limit 100","submissionTime":"2016-10-10T21:48:08.862Z","completionTime":"2016-10-10T21:48:11.800Z","stageIds":[251,255,252,256,253,257,254],"jobGroup":"hive_20161010214848_8f35894d-5987-4faf-9f01-f61c05e50714","status":"succeeded","numTasks":160,"numActiveTasks":0,"numCompletedTasks":160,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":7,"numSkippedStages":0,"numFailedStages":0},{"jobId":141,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:48:08.813Z","completionTime":"2016-10-10T21:48:09.490Z","stageIds":[250],"jobGroup":"hive_20161010214848_c283c323-4233-465f-bf6f-837e0c17f9d2","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":140,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:48:08.762Z","completionTime":"2016-10-10T21:48:09.168Z","stageIds":[249],"jobGroup":"hive_20161010214848_1c459e87-96c2-4eae-ab3e-aa19145ecf17","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":139,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:08.675Z","completionTime":"2016-10-10T21:48:10.007Z","stageIds":[248],"jobGroup":"hive_20161010214848_1d94bb8e-d97d-4542-88d3-b373bf0321ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":138,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wswscs STORED AS ORC AS select /*+MAPJOIN(date_dim)*/ d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq","submissionTime":"2016-10-10T21:48:08.617Z","completionTime":"2016-10-10T21:48:09.190Z","stageIds":[247],"jobGroup":"hive_20161010214848_a515d728-3d2c-418c-8c04-546acda1064a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":137,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:48:08.601Z","completionTime":"2016-10-10T21:48:09.073Z","stageIds":[246],"jobGroup":"hive_20161010214848_7c59d516-ebb9-42bd-a59a-20ff4df2a60f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":136,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:48:08.546Z","completionTime":"2016-10-10T21:48:08.798Z","stageIds":[245],"jobGroup":"hive_20161010214848_c6a20559-4ade-401a-a433-ad91ab48e62a","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":135,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:08.531Z","completionTime":"2016-10-10T21:48:09.988Z","stageIds":[244],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":134,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:48:08.470Z","completionTime":"2016-10-10T21:48:10.560Z","stageIds":[241,242,243],"jobGroup":"hive_20161010214848_9000973d-65d4-4677-bf8c-a0fcfe379762","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":133,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim) */\n       ca_zip\n       ,sum(cs_sales_price)\n from catalog_sales\n     JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n     JOIN (select ca_zip, ca_state, c_customer_sk\n             from customer JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n          ) x\n     ON catalog_sales.cs_bill_customer_sk = x.c_customer_sk\n  where\n        ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n                                   '85392', '85460', '80348', '81792')\n              or ca_state in ('CA','WA','GA')\n              or cs_sales_price > 500)\n        and d_qoy = 2 and d_year = 2000\n group by ca_zip\n order by ca_zip\n limit 100","submissionTime":"2016-10-10T21:48:08.421Z","completionTime":"2016-10-10T21:48:08.629Z","stageIds":[240],"jobGroup":"hive_20161010214848_8f35894d-5987-4faf-9f01-f61c05e50714","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":132,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:08.394Z","completionTime":"2016-10-10T21:48:09.099Z","stageIds":[239],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":131,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim ) */\n avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost)\n from store_sales\n     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk\n     JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk\n     JOIN household_demographics ON store_sales.ss_hdemo_sk=household_demographics.hd_demo_sk\n     JOIN store ON store.s_store_sk = store_sales.ss_store_sk\n where\n d_year = 2001\n and((\n  cd_marital_status = 'M'\n  and cd_education_status = '4 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (\n  cd_marital_status = 'D'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (\n  cd_marital_status = 'U'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((\n  ca_country = 'United States'\n  and ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 250  \n     ))","submissionTime":"2016-10-10T21:48:08.346Z","completionTime":"2016-10-10T21:48:08.612Z","stageIds":[238],"jobGroup":"hive_20161010214848_8b748e19-df3b-4847-bccf-836e45adc6e5","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":130,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:08.335Z","completionTime":"2016-10-10T21:48:08.570Z","stageIds":[237],"jobGroup":"hive_20161010214848_1d94bb8e-d97d-4542-88d3-b373bf0321ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":129,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:48:08.304Z","completionTime":"2016-10-10T21:48:11.096Z","stageIds":[233,230,234,235,227,231,228,232,229,226,236],"jobGroup":"hive_20161010214848_20a74758-13f3-456a-a168-56db7cf59166","status":"succeeded","numTasks":39,"numActiveTasks":0,"numCompletedTasks":39,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":11,"numSkippedStages":0,"numFailedStages":0},{"jobId":128,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:08.291Z","completionTime":"2016-10-10T21:48:09.252Z","stageIds":[224,225],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":127,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:48:08.245Z","completionTime":"2016-10-10T21:48:08.444Z","stageIds":[223],"jobGroup":"hive_20161010214848_0dd83141-6756-4418-8037-91cc012f88d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":126,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:48:07.980Z","completionTime":"2016-10-10T21:48:08.362Z","stageIds":[222],"jobGroup":"hive_20161010214848_9000973d-65d4-4677-bf8c-a0fcfe379762","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":125,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:48:07.973Z","completionTime":"2016-10-10T21:48:08.264Z","stageIds":[220,221],"jobGroup":"hive_20161010214848_0b85e9a0-2500-4183-af28-42d7b26b9818","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":124,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_customer_total_return STORED AS ORC AS select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return\n    from store_returns,date_dim\n    where sr_returned_date_sk = d_date_sk and d_year =2000\n    group by sr_customer_sk,sr_store_sk","submissionTime":"2016-10-10T21:48:07.966Z","completionTime":"2016-10-10T21:48:10.119Z","stageIds":[219,218],"jobGroup":"hive_20161010214848_1e449e3d-994e-4578-a37c-1699ad4d3c2f","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":123,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:48:07.884Z","completionTime":"2016-10-10T21:48:08.082Z","stageIds":[217],"jobGroup":"hive_20161010214848_20a74758-13f3-456a-a168-56db7cf59166","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":122,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_customer_total_return STORED AS ORC AS select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return\n    from store_returns,date_dim\n    where sr_returned_date_sk = d_date_sk and d_year =2000\n    group by sr_customer_sk,sr_store_sk","submissionTime":"2016-10-10T21:48:07.685Z","completionTime":"2016-10-10T21:48:07.873Z","stageIds":[216],"jobGroup":"hive_20161010214848_1e449e3d-994e-4578-a37c-1699ad4d3c2f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":121,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:48:07.562Z","completionTime":"2016-10-10T21:48:08.136Z","stageIds":[215,214],"jobGroup":"hive_20161010214848_b93b6fdd-bb37-4e22-bd32-65598a379873","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":120,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:48:07.459Z","completionTime":"2016-10-10T21:48:07.878Z","stageIds":[213],"jobGroup":"hive_20161010214848_9000973d-65d4-4677-bf8c-a0fcfe379762","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":119,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:48:07.438Z","completionTime":"2016-10-10T21:48:08.712Z","stageIds":[212],"jobGroup":"hive_20161010214848_c283c323-4233-465f-bf6f-837e0c17f9d2","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":118,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:48:07.307Z","completionTime":"2016-10-10T21:48:07.509Z","stageIds":[211],"jobGroup":"hive_20161010214848_20a74758-13f3-456a-a168-56db7cf59166","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":117,"userName":"hive","name":"runJob at FileSinkOperator.scala:234","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wscs STORED AS ORC AS select sold_date_sk\n        ,sales_price\n  from (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n          from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales) x","submissionTime":"2016-10-10T21:48:06.800Z","completionTime":"2016-10-10T21:48:08.141Z","stageIds":[210],"jobGroup":"hive_20161010214848_d80caab0-c47b-425d-a9b9-9eb2bf129f71","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":116,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:43.526Z","completionTime":"2016-10-10T21:40:47.699Z","stageIds":[204,208,205,209,206,207],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":523,"numActiveTasks":0,"numCompletedTasks":523,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":6,"numSkippedStages":0,"numFailedStages":0},{"jobId":115,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:40.121Z","completionTime":"2016-10-10T21:40:43.375Z","stageIds":[202,203],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":140,"numActiveTasks":0,"numCompletedTasks":140,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":114,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:39.605Z","completionTime":"2016-10-10T21:40:39.938Z","stageIds":[201],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":113,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:39.349Z","completionTime":"2016-10-10T21:40:39.520Z","stageIds":[200],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":112,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:39.110Z","completionTime":"2016-10-10T21:40:39.240Z","stageIds":[199],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":111,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:35.599Z","completionTime":"2016-10-10T21:40:39.009Z","stageIds":[197,198],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":140,"numActiveTasks":0,"numCompletedTasks":140,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":110,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:35.084Z","completionTime":"2016-10-10T21:40:35.402Z","stageIds":[196],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":109,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:34.829Z","completionTime":"2016-10-10T21:40:35.030Z","stageIds":[195],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":108,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:34.607Z","completionTime":"2016-10-10T21:40:34.738Z","stageIds":[194],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":107,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:31.515Z","completionTime":"2016-10-10T21:40:34.504Z","stageIds":[192,193],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":140,"numActiveTasks":0,"numCompletedTasks":140,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":106,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:31.155Z","completionTime":"2016-10-10T21:40:31.361Z","stageIds":[191],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":105,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:30.985Z","completionTime":"2016-10-10T21:40:31.106Z","stageIds":[190],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":104,"userName":"hive","name":"collect at Operator.scala:239","schedulingPool":"M0","description":"select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales)\n from(\n       select /*+MAPJOIN(date_dim, item)*/'store' channel, i_brand_id,i_class_id\n             ,i_category_id,sum(ss_quantity*ss_list_price) sales\n             , count(*) number_sales\n       from store_sales\n           ,date_dim\n           ,item\n       where ss_item_sk in (select ss_item_sk from cross_items)\n         and ss_item_sk = i_item_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales\n       from catalog_sales\n           ,date_dim\n           ,item\n       where cs_item_sk in (select ss_item_sk from cross_items)\n         and cs_item_sk = i_item_sk\n         and cs_sold_date_sk = d_date_sk\n         and d_year = 1998+2 \n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales)\n       union all\n       select /*+MAPJOIN(date_dim, item)*/ 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales\n       from web_sales\n           ,date_dim\n           ,item\n       where ws_item_sk in (select ss_item_sk from cross_items)\n         and ws_item_sk = i_item_sk\n         and ws_sold_date_sk = d_date_sk\n         and d_year = 1998+2\n         and d_moy = 11\n       group by i_brand_id,i_class_id,i_category_id\n       having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales)\n ) y\n group by rollup (channel, i_brand_id,i_class_id,i_category_id)\n order by channel,i_brand_id,i_class_id,i_category_id\n limit 100","submissionTime":"2016-10-10T21:40:30.756Z","completionTime":"2016-10-10T21:40:30.882Z","stageIds":[189],"jobGroup":"hive_20161010214040_ae153f43-902b-457e-bfda-fe5ac55752ec","status":"succeeded","numTasks":1,"numActiveTasks":0,"numCompletedTasks":1,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":103,"userName":"hive","name":"runJob at FileSinkOperator.scala:234","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:28.938Z","completionTime":"2016-10-10T21:40:29.096Z","stageIds":[188],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":102,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:28.412Z","completionTime":"2016-10-10T21:40:28.911Z","stageIds":[186,187],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":101,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:27.945Z","completionTime":"2016-10-10T21:40:29.355Z","stageIds":[184,185],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":13,"numActiveTasks":0,"numCompletedTasks":13,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":100,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:27.668Z","completionTime":"2016-10-10T21:40:28.330Z","stageIds":[183,182],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":99,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:27.499Z","completionTime":"2016-10-10T21:40:27.870Z","stageIds":[181],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":98,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:27.283Z","completionTime":"2016-10-10T21:40:27.473Z","stageIds":[180],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":97,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:27.116Z","completionTime":"2016-10-10T21:40:29.696Z","stageIds":[179,178],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":96,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:26.863Z","completionTime":"2016-10-10T21:40:27.042Z","stageIds":[177],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":95,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:26.856Z","completionTime":"2016-10-10T21:40:27.525Z","stageIds":[176,175],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":94,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.818Z","completionTime":"2016-10-10T21:40:27.260Z","stageIds":[174],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":93,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:26.562Z","completionTime":"2016-10-10T21:40:26.755Z","stageIds":[173],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":92,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.536Z","completionTime":"2016-10-10T21:40:27.609Z","stageIds":[171,172],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":9,"numActiveTasks":0,"numCompletedTasks":9,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":91,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.393Z","completionTime":"2016-10-10T21:40:26.793Z","stageIds":[170],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":90,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_avg_sales STORED AS ORC AS select avg(quantity*list_price) average_sales\n  from (select /*+MAPJOIN(date_dim)*/ ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 2001 \n       union all \n       select /*+MAPJOIN(date_dim)*/ cs_quantity quantity \n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2 \n       union all\n       select /*+MAPJOIN(date_dim)*/ ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n         and d_year between 1998 and 1998 + 2\n       ) x","submissionTime":"2016-10-10T21:40:26.250Z","completionTime":"2016-10-10T21:40:26.463Z","stageIds":[169],"jobGroup":"hive_20161010214040_11165b0b-c561-4a46-941d-ea5158d6a05c","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":89,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:26.212Z","completionTime":"2016-10-10T21:40:26.675Z","stageIds":[168,167],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":88,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:26.011Z","completionTime":"2016-10-10T21:40:26.493Z","stageIds":[166],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":87,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  2001\n   and t_s_secyear.dyear = 2001+1\n   and t_c_firstyear.dyear =  2001\n   and t_c_secyear.dyear =  2001+1\n   and t_w_firstyear.dyear = 2001\n   and t_w_secyear.dyear = 2001+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:25.745Z","completionTime":"2016-10-10T21:40:26.334Z","stageIds":[165],"jobGroup":"hive_20161010214040_1e33df27-7128-48d0-8e2d-70ce68230b3f","status":"succeeded","numTasks":12,"numActiveTasks":0,"numCompletedTasks":12,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":86,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:25.709Z","completionTime":"2016-10-10T21:40:25.998Z","stageIds":[164],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":85,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:25.637Z","completionTime":"2016-10-10T21:40:26.140Z","stageIds":[162,163],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":84,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select  t_s_secyear.customer_preferred_cust_flag\n from\n      year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 2001\n         and t_s_secyear.dyear = 2001+1\n         and t_w_firstyear.dyear = 2001\n         and t_w_secyear.dyear = 2001+1\n         and t_s_firstyear.sum_year_total > 0\n         and t_w_firstyear.sum_year_total > 0\n         and case when t_w_firstyear.sum_year_total > 0 then t_w_secyear.sum_year_total / t_w_firstyear.sum_year_total else null end\n             > case when t_s_firstyear.sum_year_total > 0 then t_s_secyear.sum_year_total / t_s_firstyear.sum_year_total else null end\n order by t_s_secyear.customer_preferred_cust_flag\n limit 100","submissionTime":"2016-10-10T21:40:25.385Z","completionTime":"2016-10-10T21:40:25.696Z","stageIds":[161],"jobGroup":"hive_20161010214040_bc2e5547-32e6-4d47-a734-5648718066f0","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":83,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:24.446Z","completionTime":"2016-10-10T21:40:25.591Z","stageIds":[159,160],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":82,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:22.770Z","completionTime":"2016-10-10T21:40:24.362Z","stageIds":[157,158],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":81,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:20.755Z","completionTime":"2016-10-10T21:40:22.654Z","stageIds":[155,156],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":80,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:17.775Z","completionTime":"2016-10-10T21:40:20.638Z","stageIds":[153,154],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":79,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:17.376Z","completionTime":"2016-10-10T21:40:18.488Z","stageIds":[151,152],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":10,"numActiveTasks":0,"numCompletedTasks":10,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":78,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:17.168Z","completionTime":"2016-10-10T21:40:25.344Z","stageIds":[150,147,144,148,145,149,146],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":526,"numActiveTasks":0,"numCompletedTasks":526,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":7,"numSkippedStages":0,"numFailedStages":0},{"jobId":77,"userName":"hive","name":"HiveRangePartitioner at RDDUtils.scala:146","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:17.025Z","completionTime":"2016-10-10T21:40:17.336Z","stageIds":[143],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":5,"numActiveTasks":0,"numCompletedTasks":5,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":76,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:16.750Z","completionTime":"2016-10-10T21:40:24.997Z","stageIds":[135,139,136,140,137,141,138,142,134],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":497,"numActiveTasks":0,"numCompletedTasks":497,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":9,"numSkippedStages":0,"numFailedStages":0},{"jobId":75,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:16.557Z","completionTime":"2016-10-10T21:40:16.960Z","stageIds":[133],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":5,"numActiveTasks":0,"numCompletedTasks":5,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":74,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:16.231Z","completionTime":"2016-10-10T21:40:16.550Z","stageIds":[132],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":73,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:16.164Z","completionTime":"2016-10-10T21:40:16.433Z","stageIds":[131],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":72,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\nfrom\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq1\n          ,sun_sales sun_sales1\n          ,mon_sales mon_sales1\n          ,tue_sales tue_sales1\n          ,wed_sales wed_sales1\n          ,thu_sales thu_sales1\n          ,fri_sales fri_sales1\n          ,sat_sales sat_sales1\n    from wswscs,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001) y,\n   (select /*+MAPJOIN(date_dim)*/ wswscs.d_week_seq d_week_seq2\n          ,sun_sales sun_sales2\n          ,mon_sales mon_sales2\n          ,tue_sales tue_sales2\n          ,wed_sales wed_sales2\n          ,thu_sales thu_sales2\n          ,fri_sales fri_sales2\n          ,sat_sales sat_sales2\n    from wswscs\n        ,date_dim\n    where date_dim.d_week_seq = wswscs.d_week_seq and\n          d_year = 2001+1) z\nwhere d_week_seq1=d_week_seq2-53\norder by d_week_seq1","submissionTime":"2016-10-10T21:40:15.796Z","completionTime":"2016-10-10T21:40:16.005Z","stageIds":[130],"jobGroup":"hive_20161010214040_a8b1f2f1-9e7b-4755-b29f-26e4936e5ee1","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":71,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:15.742Z","completionTime":"2016-10-10T21:40:15.900Z","stageIds":[129],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":70,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:15.555Z","completionTime":"2016-10-10T21:40:17.114Z","stageIds":[128],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":69,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:14.759Z","completionTime":"2016-10-10T21:40:17.634Z","stageIds":[126,127],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":68,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:14.703Z","completionTime":"2016-10-10T21:40:16.403Z","stageIds":[125,124],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":3,"numActiveTasks":0,"numCompletedTasks":3,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":67,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:12.663Z","completionTime":"2016-10-10T21:40:14.644Z","stageIds":[122,123],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":66,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:12.642Z","completionTime":"2016-10-10T21:40:14.642Z","stageIds":[121],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":4,"numActiveTasks":0,"numCompletedTasks":4,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":65,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:10.665Z","completionTime":"2016-10-10T21:40:12.564Z","stageIds":[119,120],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":64,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select  c_customer_id\n    from customer_total_return ctr1,store,customer\n    where ctr1.ctr_total_return > (\n                                    select avg(ctr_total_return)*1.2\n                                    from customer_total_return ctr2\n                                    where ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n    and s_store_sk = ctr1.ctr_store_sk\n    and s_state = 'TN'\n    and ctr1.ctr_customer_sk = c_customer_sk\n    order by c_customer_id\n    limit 100","submissionTime":"2016-10-10T21:40:10.402Z","completionTime":"2016-10-10T21:40:10.631Z","stageIds":[118],"jobGroup":"hive_20161010214040_e4668b3f-bdb8-4c7b-81e9-601e4f85611d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":63,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:10.292Z","completionTime":"2016-10-10T21:40:24.584Z","stageIds":[117,114,115,116],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":26,"numActiveTasks":0,"numCompletedTasks":26,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":4,"numSkippedStages":0,"numFailedStages":0},{"jobId":62,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:09.242Z","completionTime":"2016-10-10T21:40:15.439Z","stageIds":[113],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":61,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:08.396Z","completionTime":"2016-10-10T21:40:10.201Z","stageIds":[112],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":60,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:08.333Z","completionTime":"2016-10-10T21:40:25.540Z","stageIds":[111,109,110],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":59,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:08.190Z","completionTime":"2016-10-10T21:40:12.524Z","stageIds":[107,108],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":58,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:07.898Z","completionTime":"2016-10-10T21:40:08.292Z","stageIds":[106],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":57,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:07.657Z","completionTime":"2016-10-10T21:40:16.534Z","stageIds":[102,99,103,100,104,101,105,98],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":49,"numActiveTasks":0,"numCompletedTasks":49,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":8,"numSkippedStages":0,"numFailedStages":0},{"jobId":56,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:07.297Z","completionTime":"2016-10-10T21:40:24.743Z","stageIds":[96,97,95],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":17,"numActiveTasks":0,"numCompletedTasks":17,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":55,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:07.257Z","completionTime":"2016-10-10T21:40:08.224Z","stageIds":[93,94],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":54,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:07.230Z","completionTime":"2016-10-10T21:40:09.070Z","stageIds":[92],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":53,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:07.080Z","completionTime":"2016-10-10T21:40:07.472Z","stageIds":[91],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":52,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:06.648Z","completionTime":"2016-10-10T21:40:07.739Z","stageIds":[90],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":51,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:06.601Z","completionTime":"2016-10-10T21:40:07.075Z","stageIds":[89],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":50,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:40:06.563Z","completionTime":"2016-10-10T21:40:16.792Z","stageIds":[88,85,86,87],"jobGroup":"hive_20161010213939_1d38c432-6d6c-4893-b9e4-4db016cf2e3e","status":"succeeded","numTasks":100,"numActiveTasks":0,"numCompletedTasks":100,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":4,"numSkippedStages":0,"numFailedStages":0},{"jobId":49,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wswscs STORED AS ORC AS select /*+MAPJOIN(date_dim)*/ d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq","submissionTime":"2016-10-10T21:40:06.331Z","completionTime":"2016-10-10T21:40:15.015Z","stageIds":[84,83],"jobGroup":"hive_20161010214040_d4d23f9c-10a0-4bf0-8328-32954a8e8ed5","status":"succeeded","numTasks":13,"numActiveTasks":0,"numCompletedTasks":13,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":48,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:06.249Z","completionTime":"2016-10-10T21:40:07.038Z","stageIds":[82],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":47,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:06.209Z","completionTime":"2016-10-10T21:40:06.449Z","stageIds":[81],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":46,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:06.156Z","completionTime":"2016-10-10T21:40:06.907Z","stageIds":[80],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":45,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:06.108Z","completionTime":"2016-10-10T21:40:13.924Z","stageIds":[78,79,77],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":44,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:06.056Z","completionTime":"2016-10-10T21:40:06.441Z","stageIds":[76],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":43,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:05.911Z","completionTime":"2016-10-10T21:40:06.097Z","stageIds":[75],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":42,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:05.866Z","completionTime":"2016-10-10T21:40:07.181Z","stageIds":[74],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":41,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:05.631Z","completionTime":"2016-10-10T21:40:05.942Z","stageIds":[73],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":40,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:05.546Z","completionTime":"2016-10-10T21:40:05.902Z","stageIds":[72],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":39,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:04.979Z","completionTime":"2016-10-10T21:40:05.950Z","stageIds":[71],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":38,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wswscs STORED AS ORC AS select /*+MAPJOIN(date_dim)*/ d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq","submissionTime":"2016-10-10T21:40:04.944Z","completionTime":"2016-10-10T21:40:06.202Z","stageIds":[70],"jobGroup":"hive_20161010214040_d4d23f9c-10a0-4bf0-8328-32954a8e8ed5","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":37,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:04.681Z","completionTime":"2016-10-10T21:40:05.326Z","stageIds":[69],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":36,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:04.493Z","completionTime":"2016-10-10T21:40:07.989Z","stageIds":[67,68],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":35,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:04.429Z","completionTime":"2016-10-10T21:40:04.818Z","stageIds":[66],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":34,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:04.343Z","completionTime":"2016-10-10T21:40:04.590Z","stageIds":[65],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":33,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:04.007Z","completionTime":"2016-10-10T21:40:04.231Z","stageIds":[64],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":32,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:40:03.873Z","completionTime":"2016-10-10T21:40:12.583Z","stageIds":[63,60,56,53,57,54,61,58,55,62,59],"jobGroup":"hive_20161010213939_e8648f83-fc3e-4ef6-9695-b8619cc041f9","status":"succeeded","numTasks":39,"numActiveTasks":0,"numCompletedTasks":39,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":11,"numSkippedStages":0,"numFailedStages":0},{"jobId":31,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:03.626Z","completionTime":"2016-10-10T21:40:05.742Z","stageIds":[52],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":30,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:03.493Z","completionTime":"2016-10-10T21:40:03.748Z","stageIds":[51],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":29,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:40:03.272Z","completionTime":"2016-10-10T21:40:06.370Z","stageIds":[50],"jobGroup":"hive_20161010213939_1d38c432-6d6c-4893-b9e4-4db016cf2e3e","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":28,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:40:03.196Z","completionTime":"2016-10-10T21:40:04.310Z","stageIds":[49],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":27,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:40:03.143Z","completionTime":"2016-10-10T21:40:03.686Z","stageIds":[48],"jobGroup":"hive_20161010213939_e8648f83-fc3e-4ef6-9695-b8619cc041f9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":26,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:40:03.060Z","completionTime":"2016-10-10T21:40:03.355Z","stageIds":[47],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":25,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:40:02.635Z","completionTime":"2016-10-10T21:40:05.528Z","stageIds":[46],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":24,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:40:02.536Z","completionTime":"2016-10-10T21:40:05.728Z","stageIds":[45],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":23,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:40:02.434Z","completionTime":"2016-10-10T21:40:08.229Z","stageIds":[42,43,44],"jobGroup":"hive_20161010213939_fb6ebee0-9db4-41f4-891a-e66122c67eb6","status":"succeeded","numTasks":11,"numActiveTasks":0,"numCompletedTasks":11,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":3,"numSkippedStages":0,"numFailedStages":0},{"jobId":22,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:02.134Z","completionTime":"2016-10-10T21:40:05.905Z","stageIds":[41],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":21,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_customer_total_return STORED AS ORC AS select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return\n    from store_returns,date_dim\n    where sr_returned_date_sk = d_date_sk and d_year =2000\n    group by sr_customer_sk,sr_store_sk","submissionTime":"2016-10-10T21:40:01.878Z","completionTime":"2016-10-10T21:40:09.492Z","stageIds":[39,40],"jobGroup":"hive_20161010213939_09683529-e037-423a-a290-61db5d2ffc03","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":20,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:40:01.713Z","completionTime":"2016-10-10T21:40:04.422Z","stageIds":[37,38],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":19,"userName":"hive","name":"mapPartitions at RDDUtils.scala:212","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim) */\n       ca_zip\n       ,sum(cs_sales_price)\n from catalog_sales\n     JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n     JOIN (select ca_zip, ca_state, c_customer_sk\n             from customer JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n          ) x\n     ON catalog_sales.cs_bill_customer_sk = x.c_customer_sk\n  where\n        ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n                                   '85392', '85460', '80348', '81792')\n              or ca_state in ('CA','WA','GA')\n              or cs_sales_price > 500)\n        and d_qoy = 2 and d_year = 2000\n group by ca_zip\n order by ca_zip\n limit 100","submissionTime":"2016-10-10T21:40:01.495Z","completionTime":"2016-10-10T21:40:16.260Z","stageIds":[33,30,34,31,35,32,36],"jobGroup":"hive_20161010213939_016b5f69-08c4-42b2-aea4-21c065f872ab","status":"succeeded","numTasks":160,"numActiveTasks":0,"numCompletedTasks":160,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":7,"numSkippedStages":0,"numFailedStages":0},{"jobId":18,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:40:01.449Z","completionTime":"2016-10-10T21:40:15.540Z","stageIds":[29],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":17,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim ) */\n avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost)\n from store_sales\n     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk\n     JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk\n     JOIN household_demographics ON store_sales.ss_hdemo_sk=household_demographics.hd_demo_sk\n     JOIN store ON store.s_store_sk = store_sales.ss_store_sk\n where\n d_year = 2001\n and((\n  cd_marital_status = 'M'\n  and cd_education_status = '4 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (\n  cd_marital_status = 'D'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (\n  cd_marital_status = 'U'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((\n  ca_country = 'United States'\n  and ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 250  \n     ))","submissionTime":"2016-10-10T21:40:01.373Z","completionTime":"2016-10-10T21:40:13.981Z","stageIds":[27,19,20,24,21,28,25,22,26,23],"jobGroup":"hive_20161010213939_ce8ef292-2595-4695-8b31-a2166386751b","status":"succeeded","numTasks":207,"numActiveTasks":0,"numCompletedTasks":207,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":10,"numSkippedStages":0,"numFailedStages":0},{"jobId":16,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:40:01.155Z","completionTime":"2016-10-10T21:40:02.039Z","stageIds":[18],"jobGroup":"hive_20161010213939_fb6ebee0-9db4-41f4-891a-e66122c67eb6","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":15,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:40:01.016Z","completionTime":"2016-10-10T21:40:03.324Z","stageIds":[17],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":14,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"with ssr as (\nselect /*+MAPJOIN(date_dim,store)*/\n        s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from store_sales,\n     date_dim\n where ss_sold_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select sr_store_sk as store_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns,\n     date_dim\n where sr_returned_date_sk = d_date_sk\n       and d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns1,\n     store\n where \n--lesreturns1.date_sk = date_dim.d_date_sk\n--     and d_date between '1998-08-04' and '1998-08-18'\n--       and cast(d_date as date) between cast('1998-08-04' as date) \n--                  and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns1.store_sk = store.s_store_sk\n group by s_store_id),\n\n with csr as (\n select /*+MAPJOIN(date_dim,catalog_page)*/\n      cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from catalog_sales, date_dim\n    where cs_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns, date_dim\n    where cr_returned_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n   ) salesreturns2,\n     catalog_page\n where\n       --and cast(d_date as date) between cast('1998-08-04' as date)\n        --          and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns2.page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id),\n\n with wsr as(\n  select /*+MAPJOIN(date_dim,web_site)*/\n        web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as double) as return_amt,\n            cast(0 as double) as net_loss\n    from web_sales, date_dim\n    where ws_sold_date_sk = d_date_sk and d_date between '1998-08-04' and '1998-08-18'\n    \n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           cast(0 as double) as sales_price,\n           cast(0 as double) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns\n\t join date_dim on wr_returned_date_sk = d_date_sk\n\t left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n    where d_date between '1998-08-04' and '1998-08-18'\n   ) salesreturns3,\n     web_site\n where \n       --and cast(d_date as date) between cast('1998-08-04' as date)\n       --           and (cast('1998-08-04' as date) +  INTERVAL '14' day)\n       salesreturns3.wsr_web_site_sk = web_site_sk\n group by web_site_id)\n\nselect  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\ngroup by rollup (channel, id)\norder by channel,id\nlimit 100","submissionTime":"2016-10-10T21:39:54.318Z","completionTime":"2016-10-10T21:40:02.622Z","stageIds":[16],"jobGroup":"hive_20161010213939_479a5051-2e04-4469-ad90-19ed971264d9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":13,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"create temporary table  cross_items stored as orc as\n--with  cross_items as\n-- (\nselect i_item_sk ss_item_sk\n from item,\n (select /*+MAPJOIN(d1, iss)*/ iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,date_dim d1\n     ,item iss\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect \n select /*+MAPJOIN(d2, ics)*/ ics.i_brand_id brand_id\n     ,ics.i_class_id class_id\n     ,ics.i_category_id category_id\n from catalog_sales\n     ,date_dim d2\n     ,item ics\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n intersect\n select /*+MAPJOIN(d3, iws)*/ iws.i_brand_id brand_id\n     ,iws.i_class_id class_id\n     ,iws.i_category_id category_id\n from web_sales\n     ,date_dim d3\n     ,item iws\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and d3.d_year between 1999 AND 1999 + 2\n group by brand_id, class_id, category_id\n ) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n--),","submissionTime":"2016-10-10T21:39:53.845Z","completionTime":"2016-10-10T21:40:02.107Z","stageIds":[15],"jobGroup":"hive_20161010213939_e91ef336-49f2-47f6-be6d-8422864aae7b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":12,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Walker County','Richland County','Gaines County','Douglas County','Dona Ana County') and\n  cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select 1 \n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 and 4+3) and\n  exists (select /*+MAPJOIN(date_dim)*/ 1\n          from (\n             select ws_bill_customer_sk as customer_sk,ws_sold_date_sk as date_sk\n             from web_sales\n             union \n             select cs_ship_customer_sk as customer_sk,cs_sold_date_sk as date_sk\n             from catalog_sales) x\n          ,date_dim\n          where c.c_customer_sk = x.customer_sk and\n                x.date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 4 ANd 4+3) \n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100","submissionTime":"2016-10-10T21:39:53.624Z","completionTime":"2016-10-10T21:40:01.346Z","stageIds":[14],"jobGroup":"hive_20161010213939_a5445fdb-a1fd-43b4-9b47-fdc335b172dc","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":11,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n   from store_sales\n        ,date_dim\n        ,customer\n   where c_customer_sk = ss_customer_sk\n     and ss_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n   from catalog_sales\n       ,date_dim\n       ,customer\n   where c_customer_sk = cs_bill_customer_sk\n         and cs_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n   from  web_sales\n     ,date_dim\n     ,customer\n   where c_customer_sk = ws_bill_customer_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year in (2001, 2001 + 1)\n   group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:39:53.517Z","completionTime":"2016-10-10T21:40:01.681Z","stageIds":[13],"jobGroup":"hive_20161010213939_2a261f37-6906-43df-bc60-463bd7f0b948","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":10,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim ) */\n avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost)\n from store_sales\n     JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n     JOIN customer_demographics ON customer_demographics.cd_demo_sk = store_sales.ss_cdemo_sk\n     JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk\n     JOIN household_demographics ON store_sales.ss_hdemo_sk=household_demographics.hd_demo_sk\n     JOIN store ON store.s_store_sk = store_sales.ss_store_sk\n where\n d_year = 2001\n and((\n  cd_marital_status = 'M'\n  and cd_education_status = '4 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3   \n     )or\n     (\n  cd_marital_status = 'D'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00   \n  and hd_dep_count = 1\n     ) or \n     (\n  cd_marital_status = 'U'\n  and cd_education_status = 'Advanced Degree'\n  and ss_sales_price between 150.00 and 200.00 \n  and hd_dep_count = 1  \n     ))\n and((\n  ca_country = 'United States'\n  and ca_state in ('KY', 'GA', 'NM')\n  and ss_net_profit between 100 and 200  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('MT', 'OR', 'IN')\n  and ss_net_profit between 150 and 300  \n     ) or\n     (\n  ca_country = 'United States'\n  and ca_state in ('WI', 'MO', 'WV')\n  and ss_net_profit between 50 and 250  \n     ))","submissionTime":"2016-10-10T21:39:53.264Z","completionTime":"2016-10-10T21:40:00.946Z","stageIds":[12],"jobGroup":"hive_20161010213939_ce8ef292-2595-4695-8b31-a2166386751b","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":9,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select  a.ca_state state, count(*) cnt\n from customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n     ,customer_address a\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 2 )\n \tand i.i_current_price > 1.2 * \n           (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt \n limit 100","submissionTime":"2016-10-10T21:39:53.202Z","completionTime":"2016-10-10T21:40:02.080Z","stageIds":[10,11],"jobGroup":"hive_20161010213939_941834c1-ee99-4ddf-8075-f07be1427d2d","status":"succeeded","numTasks":6,"numActiveTasks":0,"numCompletedTasks":6,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0},{"jobId":8,"userName":"hive","name":"runJob at FileSinkOperator.scala:234","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_wscs STORED AS ORC AS select sold_date_sk\n        ,sales_price\n  from (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n          from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales) x","submissionTime":"2016-10-10T21:39:53.142Z","completionTime":"2016-10-10T21:40:04.376Z","stageIds":[9],"jobGroup":"hive_20161010213939_2beea94b-fab6-4a01-b3d5-8405ff130a5a","status":"succeeded","numTasks":8,"numActiveTasks":0,"numCompletedTasks":8,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":7,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"CREATE TEMPORARY TABLE with_as_table_year_total STORED AS ORC AS select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) sum_year_total\n       ,'s' sale_type\n from store_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select /*+ MAPJOIN(date_dim)*/ c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) sum_year_total\n       ,'w' sale_type\n from web_sales\n     ,date_dim\n     ,customer\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (2001, 2001 + 1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year","submissionTime":"2016-10-10T21:39:53.094Z","completionTime":"2016-10-10T21:40:00.897Z","stageIds":[8],"jobGroup":"hive_20161010213939_184b987f-4ddc-466e-af00-599277e63751","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":6,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /*+ MAPJOIN(customer_demographics, date_dim, promotion) */ \n        i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales\n      JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      JOIN customer_demographics ON store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk\n      JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk\n      JOIN item ON store_sales.ss_item_sk = item.i_item_sk\n where \n       cd_gender = 'F' and \n       cd_marital_status = 'W' and\n       cd_education_status = 'Primary' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 1998\n group by i_item_id\n order by i_item_id\n limit 100","submissionTime":"2016-10-10T21:39:53.055Z","completionTime":"2016-10-10T21:40:02.703Z","stageIds":[7],"jobGroup":"hive_20161010213939_70f9a39c-2e36-400d-88b8-bbafcc38849f","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":5,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select \n      /*+ MAPJOIN(item, date_dim)*/\n       i_item_desc\n      ,i_category\n      ,i_item_id\n      ,i_class\n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue\n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n       (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,date_dim\n    \t,item\nwhere\n\tws_item_sk = i_item_sk\n  \tand ws_sold_date_sk = d_date_sk\n  \tand i_category in ('Jewelry', 'Sports', 'Books')\n\tand d_date between cast('2001-01-12' as date)\n\tand (cast('2001-01-12' as date) + INTERVAL '30' day)\ngroup by\n\ti_item_id\n        ,i_item_desc\n        ,i_category\n        ,i_class\n        ,i_current_price\norder by\n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n\n-- end query 1 in stream 0 using template query12.tpl","submissionTime":"2016-10-10T21:39:52.939Z","completionTime":"2016-10-10T21:40:02.768Z","stageIds":[6],"jobGroup":"hive_20161010213939_1d38c432-6d6c-4893-b9e4-4db016cf2e3e","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":4,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"CREATE TEMPORARY TABLE with_as_table_customer_total_return STORED AS ORC AS select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return\n    from store_returns,date_dim\n    where sr_returned_date_sk = d_date_sk and d_year =2000\n    group by sr_customer_sk,sr_store_sk","submissionTime":"2016-10-10T21:39:52.903Z","completionTime":"2016-10-10T21:40:01.688Z","stageIds":[5],"jobGroup":"hive_20161010213939_09683529-e037-423a-a290-61db5d2ffc03","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":3,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"H0","description":"select /* +MAPJOIN(date_dim, store)*/ s_store_name\n      ,sum(ss_net_profit)\n from \n     (select /* +MAPJOIN(date_dim, store)*/ss_store_sk,ss_net_profit from store_sales, date_dim\n        where ss_sold_date_sk = d_date_sk\n              and d_qoy = 1 and d_year = 2002) tmp_ss,\n     (select /* +MAPJOIN(date_dim, store)*/s_store_sk,s_store_name from store,\n     (select ca_zip\n     from (\n      SELECT substr(ca_zip,1,5) ca_zip\n      FROM customer_address\n      WHERE substr(ca_zip,1,5) IN (\n                          '89436','30868','65085','22977','83927','77557',\n                          '58429','40697','80614','10502','32779',\n                          '91137','61265','98294','17921','18427',\n                          '21203','59362','87291','84093','21505',\n                          '17184','10866','67898','25797','28055',\n                          '18377','80332','74535','21757','29742',\n                          '90885','29898','17819','40811','25990',\n                          '47513','89531','91068','10391','18846',\n                          '99223','82637','41368','83658','86199',\n                          '81625','26696','89338','88425','32200',\n                          '81427','19053','77471','36610','99823',\n                          '43276','41249','48584','83550','82276',\n                          '18842','78890','14090','38123','40936',\n                          '34425','19850','43286','80072','79188',\n                          '54191','11395','50497','84861','90733',\n                          '21068','57666','37119','25004','57835',\n                          '70067','62878','95806','19303','18840',\n                          '19124','29785','16737','16022','49613',\n                          '89977','68310','60069','98360','48649',\n                          '39050','41793','25002','27413','39736',\n                          '47208','16515','94808','57648','15009',\n                          '80015','42961','63982','21744','71853',\n                          '81087','67468','34175','64008','20261',\n                          '11201','51799','48043','45645','61163',\n                          '48375','36447','57042','21218','41100',\n                          '89951','22745','35851','83326','61125',\n                          '78298','80752','49858','52940','96976',\n                          '63792','11376','53582','18717','90226',\n                          '50530','94203','99447','27670','96577',\n                          '57856','56372','16165','23427','54561',\n                          '28806','44439','22926','30123','61451',\n                          '92397','56979','92309','70873','13355',\n                          '21801','46346','37562','56458','28286',\n                          '47306','99555','69399','26234','47546',\n                          '49661','88601','35943','39936','25632',\n                          '24611','44166','56648','30379','59785',\n                          '11110','14329','93815','52226','71381',\n                          '13842','25612','63294','14664','21077',\n                          '82626','18799','60915','81020','56447',\n                          '76619','11433','13414','42548','92713',\n                          '70467','30884','47484','16072','38936',\n                          '13036','88376','45539','35901','19506',\n                          '65690','73957','71850','49231','14276',\n                          '20005','18384','76615','11635','38177',\n                          '55607','41369','95447','58581','58149',\n                          '91946','33790','76232','75692','95464',\n                          '22246','51061','56692','53121','77209',\n                          '15482','10688','14868','45907','73520',\n                          '72666','25734','17959','24677','66446',\n                          '94627','53535','15560','41967','69297',\n                          '11929','59403','33283','52232','57350',\n                          '43933','40921','36635','10827','71286',\n                          '19736','80619','25251','95042','15526',\n                          '36496','55854','49124','81980','35375',\n                          '49157','63512','28944','14946','36503',\n                          '54010','18767','23969','43905','66979',\n                          '33113','21286','58471','59080','13395',\n                          '79144','70373','67031','38360','26705',\n                          '50906','52406','26066','73146','15884',\n                          '31897','30045','61068','45550','92454',\n                          '13376','14354','19770','22928','97790',\n                          '50723','46081','30202','14410','20223',\n                          '88500','67298','13261','14172','81410',\n                          '93578','83583','46047','94167','82564',\n                          '21156','15799','86709','37931','74703',\n                          '83103','23054','70470','72008','49247',\n                          '91911','69998','20961','70070','63197',\n                          '54853','88191','91830','49521','19454',\n                          '81450','89091','62378','25683','61869',\n                          '51744','36580','85778','36871','48121',\n                          '28810','83712','45486','67393','26935',\n                          '42393','20132','55349','86057','21309',\n                          '80218','10094','11357','48819','39734',\n                          '40758','30432','21204','29467','30214',\n                          '61024','55307','74621','11622','68908',\n                          '33032','52868','99194','99900','84936',\n                          '69036','99149','45013','32895','59004',\n                          '32322','14933','32936','33562','72550',\n                          '27385','58049','58200','16808','21360',\n                          '32961','18586','79307','15492')\n            group by ca_zip\n     intersect\n     select ca_zip\n      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt\n            FROM customer_address, customer\n            WHERE ca_address_sk = c_current_addr_sk and\n                  c_preferred_cust_flag='Y'\n            group by ca_zip\n            having count(*) > 10)A1)A2) V1\n     where substr(s_zip,1,2) = substr(V1.ca_zip,1,2) ) tmp_zip\n\n   where tmp_ss.ss_store_sk = tmp_zip.s_store_sk\n   group by s_store_name\n   order by s_store_name\n\n  limit 100","submissionTime":"2016-10-10T21:39:52.849Z","completionTime":"2016-10-10T21:40:02.090Z","stageIds":[4],"jobGroup":"hive_20161010213939_e8648f83-fc3e-4ef6-9695-b8619cc041f9","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":2,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"R0","description":"select \n   /*+MAPJOIN(dt, item)*/\n     dt.d_year \n    ,item.i_brand_id brand_id \n    ,item.i_brand brand\n    ,sum(ss_ext_sales_price) sum_agg\nfrom  date_dim dt \n  ,store_sales\n  ,item\nwhere dt.d_date_sk = store_sales.ss_sold_date_sk\nand store_sales.ss_item_sk = item.i_item_sk\nand item.i_manufact_id = 436\nand dt.d_moy=12\ngroup by dt.d_year\n  ,item.i_brand\n  ,item.i_brand_id\norder by dt.d_year\n     ,sum_agg desc\n     ,brand_id\nlimit 100\n\n-- end query 1 in stream 0 using template query3.tpl","submissionTime":"2016-10-10T21:39:52.811Z","completionTime":"2016-10-10T21:40:01.096Z","stageIds":[3],"jobGroup":"hive_20161010213939_fb6ebee0-9db4-41f4-891a-e66122c67eb6","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":1,"userName":"hive","name":"foreach at MapJoinOperator.scala:375","schedulingPool":"M0","description":"select /*+ MAPJOIN(date_dim) */\n       ca_zip\n       ,sum(cs_sales_price)\n from catalog_sales\n     JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n     JOIN (select ca_zip, ca_state, c_customer_sk\n             from customer JOIN customer_address ON customer.c_current_addr_sk = customer_address.ca_address_sk\n          ) x\n     ON catalog_sales.cs_bill_customer_sk = x.c_customer_sk\n  where\n        ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',\n                                   '85392', '85460', '80348', '81792')\n              or ca_state in ('CA','WA','GA')\n              or cs_sales_price > 500)\n        and d_qoy = 2 and d_year = 2000\n group by ca_zip\n order by ca_zip\n limit 100","submissionTime":"2016-10-10T21:39:52.760Z","completionTime":"2016-10-10T21:40:01.248Z","stageIds":[2],"jobGroup":"hive_20161010213939_016b5f69-08c4-42b2-aea4-21c065f872ab","status":"succeeded","numTasks":2,"numActiveTasks":0,"numCompletedTasks":2,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":1,"numSkippedStages":0,"numFailedStages":0},{"jobId":0,"userName":"hive","name":"mapPartitionsWithContext at Operator.scala:576","schedulingPool":"H0","description":"select case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 1 and 20) > 25437\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 1 and 20)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1, \n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 22746\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 21 and 40)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 9387\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 10098\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 18213\n            then (select avg(ss_ext_discount_amt)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1","submissionTime":"2016-10-10T21:39:52.611Z","completionTime":"2016-10-10T21:40:01.558Z","stageIds":[0,1],"jobGroup":"hive_20161010213939_b0982752-a32d-417c-a54a-79dc89044665","status":"succeeded","numTasks":7,"numActiveTasks":0,"numCompletedTasks":7,"numSkippedTasks":0,"numFailedTasks":0,"numActiveStages":0,"numCompletedStages":2,"numSkippedStages":0,"numFailedStages":0}]